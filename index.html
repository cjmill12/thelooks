<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hairstyle Virtual Try-On</title>
    
    <style>
/* --- Global Colors --- */
:root {
    --primary-color: #1D2124; 
    --text-on-dark: #FFFFFF; 
    --background-color: #f4f7f6;
    --text-color: #333; 
    --highlight-color: #28a745; 
    --thumbnail-size: 60px;
    --gallery-gap: 10px; 
    --header-height: 45px; 
    --viewport-size-desktop: 300px; 
    --viewport-size-mobile: 250px; 
    --content-max-width: 400px; 
    --secondary-highlight: #007bff; /* Blue for booking */
}

body {
    font-family: Arial, sans-serif;
    background-color: var(--background-color);
    color: var(--text-color);
    margin: 0;
    padding: 0; 
    text-align: center;
    -webkit-user-select: none;
    user-select: none;
    overflow-x: hidden; 
    display: flex;
    flex-direction: column;
    min-height: 100vh;
}

/* --- Header and Logo Styling (MINIMAL BANNER) --- */
#app-header {
    padding: 0; 
    background-color: #FFFFFF;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05); 
    height: var(--header-height); 
    display: flex;
    align-items: center;
    justify-content: center;
    position: sticky; 
    top: 0;
    z-index: 100;
}

#main-title-container {
    display: flex;
    align-items: center;
    gap: 8px; 
    margin: 0;
    padding: 0;
}

#main-title {
    color: var(--primary-color);
    font-size: 1.8em; 
    font-weight: bold;
    line-height: 1;
    margin: 0;
    padding: 0;
    font-family: Georgia, 'Times New Roman', Times, serif;
}

/* ================================================== */
/* NEW SINGLE-COLUMN LAYOUT */
/* ================================================== */

#main-app-container {
    flex-grow: 1; 
    width: 100%;
    padding: 20px 0;
    margin: 0 auto; 
    display: flex;
    flex-direction: column;
    align-items: center; 
    gap: 15px; 
}

/* --- 1. GENDER BUTTONS (Top Section) --- */
.gender-buttons-container {
    display: flex;
    justify-content: space-between;
    gap: 8px;
    width: 90%; 
    max-width: var(--content-max-width);
    margin-bottom: 0;
    box-sizing: border-box;
    padding: 0 10px;
}

.gender-button {
    flex-grow: 1;
    padding: 7px 10px; 
    border: 1px solid #ddd; 
    background-color: #ffffff; 
    color: var(--text-color);
    border-radius: 20px; 
    cursor: pointer;
    font-size: 0.8em; 
    font-weight: 500; 
    text-align: center;
    transition: all 0.2s;
    user-select: none;
    line-height: 1;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05); 
}

.gender-button:hover {
    background-color: #f0f0f0;
}

.gender-button.selected {
    background-color: var(--primary-color);
    color: var(--text-on-dark);
    border-color: var(--primary-color);
    box-shadow: 0 2px 5px rgba(29, 33, 36, 0.2); 
}


/* --- 2. CAMERA SECTION (Middle Section) --- */

#central-section {
    width: 90%;
    max-width: var(--content-max-width);
    display: flex;
    flex-direction: column; 
    align-items: center;
    justify-content: center;
    gap: 15px;
    padding: 0 10px;
}

#central-viewport {
    position: relative; 
    width: var(--viewport-size-mobile) !important; 
    height: var(--viewport-size-mobile) !important;
    max-width: var(--viewport-size-desktop) !important; 
    max-height: var(--viewport-size-desktop) !important;
    margin: 0; 
    border-radius: 6px; 
    overflow: hidden;
    background-color: #e0e0e0; 
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); 
    
    display: flex; 
    align-items: center;
    justify-content: center;
    cursor: pointer; 
    flex-shrink: 0; 
}

/* --- DOTTED HEADSHOT SILHOUETTE STYLES --- */

#camera-placeholder-icon {
    position: relative;
    width: 60%; 
    height: 60%; 
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    border: 3px dashed #777; 
    border-radius: 6px;
    background-color: #e8e8e8;
}

#camera-placeholder-icon::before {
    content: '';
    position: absolute;
    top: 15%; 
    width: 40%;
    height: 40%;
    background-color: #aaa;
    border-radius: 50%;
}

#camera-placeholder-icon::after {
    content: '';
    position: absolute;
    bottom: -15%; 
    width: 80%;
    height: 60%;
    background-color: #aaa;
    border-radius: 50% 50% 0 0; 
}

#video-feed, #ai-result {
    width: 100% !important;
    height: 100% !important; 
    display: block;
    object-fit: cover !important; 
    max-width: 100% !important;
    max-height: 100% !important;
    z-index: 1; 
    display: none; 
}

#status-message {
    position: absolute;
    bottom: 0;
    width: 100%;
    background: rgba(0, 0, 0, 0.6);
    color: white;
    padding: 8px 5px;
    margin: 0;
    font-size: 0.85em;
    text-align: center;
    z-index: 100; 
}

/* --- NEW: Circular Button Styling (ALL ACTION BUTTONS) --- */
.main-action-btn {
    cursor: pointer;
    border: none;
    transition: all 0.2s cubic-bezier(0.17, 0.67, 0.83, 0.67);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2); 
}

.main-action-btn:active {
    transform: scale(0.9); 
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
}

.circular-action-btn {
    width: 50px; 
    height: 50px; 
    padding: 0;
    border-radius: 50%; 
    background-color: var(--primary-color);
    color: var(--text-on-dark);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px; 
    line-height: 1;
    margin: 0; 
    flex-shrink: 0;
}

#camera-capture-btn {
    border: 4px solid var(--text-on-dark); 
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
}

#generate-look-btn {
    background-color: var(--highlight-color); 
    color: white; 
    box-shadow: 0 4px 12px rgba(40, 167, 69, 0.4); 
}

#redo-selfie-btn {
    background-color: white;
    color: var(--primary-color); 
    border: 1px solid #ddd;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
}

#book-appointment-btn {
    width: 100%; 
    height: 45px; 
    padding: 0 20px;
    border-radius: 25px;
    background-color: var(--secondary-highlight); 
    color: white; 
    font-size: 1.1em;
    font-weight: bold;
    box-shadow: 0 4px 12px rgba(0, 123, 255, 0.4); 
    margin-top: 10px; 
    display: none; 
    transition: all 0.2s;
}

#book-appointment-btn:active {
    transform: scale(0.98); 
    box-shadow: 0 2px 6px rgba(0, 123, 255, 0.6);
}

#controls-footer-row {
    display: flex;
    justify-content: center; 
    gap: 30px; 
    width: 90%; 
    max-width: var(--content-max-width);
    padding: 0 10px;
    min-height: 50px; 
    align-items: center;
    position: relative; 
    flex-wrap: wrap; 
}

#loading-spinner {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
}

.filter-section {
    width: 90%; 
    max-width: var(--content-max-width);
    margin: 0 auto; 
    padding: 0;
    background-color: #fff;
    border-radius: 6px;
    text-align: left; 
}

.filter-section h3 {
    font-size: 0.9em; 
    font-weight: bold;
    margin: 0; 
    padding: 8px 10px;
    text-transform: uppercase;
    display: flex;
    justify-content: space-between; 
    align-items: center;
    cursor: pointer;
    background-color: #fff;
    border-radius: 6px;
    transition: all 0.2s ease-in-out;
}

.filter-section.collapsed h3 {
    background-color: #f0f0f0; 
    color: #666;
    border-radius: 15px; 
    height: 28px; 
    width: auto; 
    max-width: 160px; 
    padding: 0 15px; 
    justify-content: center;
    overflow: hidden; 
    margin: 0 auto 10px auto; 
    font-size: 0.75em; 
}

.filter-section.collapsed h3 span {
    display: inline;
    line-height: 28px; 
}

.filter-section.collapsed h3::after {
    content: none;
}

.filter-section.expanded h3 {
    background-color: var(--primary-color); 
    color: var(--text-on-dark);
    border-radius: 6px 6px 0 0; 
    height: auto;
    width: 100%;
    max-width: var(--content-max-width); 
    padding: 8px 10px;
    margin: 0;
    justify-content: space-between; 
}

.filter-section h3::after {
    content: 'â–¶'; 
    font-size: 0.8em;
    margin-left: 5px;
    transition: transform 0.2s;
    line-height: 1;
}

.filter-section.expanded h3::after {
    content: 'â–¼'; 
    color: var(--text-on-dark);
}

.filter-content-group {
    padding: 5px 10px 10px 10px;
    background-color: #f9f9f9;
    border-radius: 0 0 6px 6px;
}

.filter-section.collapsed .filter-content-group {
    display: none;
}

.filter-options-group {
    display: flex;
    flex-wrap: wrap; 
    gap: 8px; 
    justify-content: flex-start; 
    margin-top: 5px; 
}

#complexion-options-group {
    justify-content: flex-start; 
    gap: 6px; 
    padding-top: 5px; 
}

.complexion-tile {
    width: 30px; 
    height: 30px; 
    border: 2px solid transparent; 
    flex-shrink: 0; 
    border-radius: 50%;
    cursor: pointer; 
}

.complexion-tile p {
    display: none; 
}

.complexion-tile.selected {
    border-color: var(--highlight-color);
    box-shadow: 0 0 5px rgba(40, 167, 69, 0.5); 
}

#style-inspiration-section {
    width: 90%; 
    max-width: var(--content-max-width);
    margin: 0 auto;
    padding: 0 10px;
    text-align: center; 
}
#style-inspiration-section p {
    font-size: 0.9em; 
    font-weight: bold;
    margin: 0 0 5px 0;
}

.hairstyle-options-group-wrapper {
    display: flex; 
    flex-wrap: nowrap; 
    white-space: nowrap; 
    overflow-x: scroll; 
    overflow-y: hidden; 
    scroll-snap-type: x mandatory; 
    scroll-behavior: smooth; 
    gap: 8px;
    padding-bottom: 10px; 
    -webkit-overflow-scrolling: touch; 
}

.style-option {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    width: 120px; 
    flex-shrink: 0;
    border: 2px solid transparent; 
    transition: all 0.3s ease-out; 
    cursor: pointer;
    transform-origin: center bottom; 
}

.style-option:hover {
    box-shadow: 0 0 3px rgba(0, 0, 0, 0.1); 
}

.style-option.selected {
    border-color: var(--highlight-color);
    border-radius: 10px; 
    box-shadow: 0 0 12px rgba(40, 167, 69, 0.9) !important; 
    transform: scale(1.2) !important; 
    z-index: 10 !important; 
}

.style-thumbnail {
    width: 120px; 
    height: 120px; 
    border-radius: 50%; 
    object-fit: cover;
    object-position: top; 
    margin-bottom: 0px; 
}

.style-option p {
    display: none; 
}

.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    visibility: hidden; 
    opacity: 0;
    transition: visibility 0s, opacity 0.3s;
}

.modal-overlay.visible {
    visibility: visible;
    opacity: 1;
}

.booking-modal {
    background: white;
    padding: 20px;
    border-radius: 8px;
    width: 90%;
    max-width: 400px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    position: relative;
    max-height: 80vh;
    overflow-y: auto;
}

.booking-modal h2 {
    margin-top: 0;
    color: var(--primary-color);
    font-size: 1.5em;
    border-bottom: 1px solid #eee;
    padding-bottom: 10px;
}

.modal-close-btn {
    position: absolute;
    top: 10px;
    right: 10px;
    background: none;
    border: none;
    font-size: 1.5em;
    cursor: pointer;
    color: #666;
}

.modal-content label {
    display: block;
    margin-top: 10px;
    text-align: left;
    font-weight: bold;
    font-size: 0.9em;
}

.modal-content input, .modal-content select, .modal-content button.submit-btn {
    width: 100%;
    padding: 10px;
    margin-top: 5px;
    box-sizing: border-box;
    border: 1px solid #ccc;
    border-radius: 4px;
    font-size: 1em;
}

.modal-content button.submit-btn {
    margin-top: 20px;
    background-color: var(--secondary-highlight);
    color: white;
    border: none;
    cursor: pointer;
    transition: background-color 0.2s;
}

.modal-content button.submit-btn:hover {
    background-color: #0056b3;
}

#reference-image-preview {
    width: 100%;
    height: auto;
    max-height: 100px;
    object-fit: contain;
    margin-top: 10px;
    border-radius: 4px;
    border: 1px solid #ddd;
    display: block;
}

@media (max-width: 600px) {
    #main-app-container {
        padding: 10px 0;
        gap: 15px; 
    }
    
    .gender-buttons-container,
    #central-section,
    #style-inspiration-section,
    #additional-filters-selector,
    #controls-footer-row {
        width: 95%; 
        max-width: 95%;
        box-sizing: border-box;
        padding: 0 10px;
    }
    
    #central-viewport {
        width: 80vw !important; 
        height: 80vw !important;
        max-width: 300px !important; 
        max-height: 300px !important;
    }
    
    #complexion-options-group {
        justify-content: space-around;
        flex-wrap: nowrap;
        overflow-x: scroll;
        padding-bottom: 5px;
        padding-top: 5px;
        scroll-snap-type: x mandatory;
    }
    
    .complexion-tile {
        width: 40px; 
        height: 40px; 
        flex-shrink: 0;
        position: relative;
    }
}
    </style>
</head>
<body>
    <div id="app-header">
        <div id="main-title-container">
            <h1 id="main-title">Looks</h1>
        </div>
    </div>

    <div id="main-app-container">
        <div class="gender-buttons-container">
            <button id="male-gender-btn" class="gender-button">Male</button>
            <button id="female-gender-btn" class="gender-button">Female</button>
        </div>

        <div id="additional-filters-selector" class="filter-section collapsed">
            <h3><span>+ Additional Filters</span><span class="icon"></span></h3>
            <div class="filter-content-group">
                <p style="font-size: 0.9em; font-weight: bold; margin-bottom: 5px;">Complexion (Optional)</p>
                <div id="complexion-options-group" class="filter-options-group">
                    <div class="complexion-tile" style="background-color: #F8D7BE;" data-complexion="Light" data-complexion-code="default"></div>
                    <div class="complexion-tile" style="background-color: #D6A476;" data-complexion="Medium" data-complexion-code="default"></div>
                    <div class="complexion-tile" style="background-color: #A97A52;" data-complexion="Dark" data-complexion-code="ds"></div>
                    <div class="complexion-tile" style="background-color: #6A3E26;" data-complexion="Deep" data-complexion-code="ds"></div>
                </div>
            </div>
        </div>
        
        <div id="central-section">
            <div id="central-viewport">
                <div id="camera-placeholder-icon"></div>
                <video id="video-feed" autoplay playsinline></video>
                <img id="ai-result" style="display: none;" src="" alt="AI Hairstyle Result">
                <p id="status-message">Tap the silhouette above to take a selfie.</p>
            </div>
        </div>
        
        <div id="controls-footer-row">
            <button id="camera-capture-btn" class="circular-action-btn main-action-btn" disabled>ðŸ“¸</button> 
            <button id="redo-selfie-btn" class="circular-action-btn main-action-btn" style="display: none;">ðŸ”„</button>
            <button id="generate-look-btn" class="circular-action-btn main-action-btn" style="display: none;">âœ¨</button>
            <div id="loading-spinner" class="spinner" style="display: none;"></div>
            <button id="book-appointment-btn" class="main-action-btn" style="display: none;">Book Appointment</button>
        </div>

        <div id="style-inspiration-section">
            <p>Get the Look</p>
            <div id="male-hairstyle-options-group" class="hairstyle-options-group-wrapper"></div>
            <div id="female-hairstyle-options-group" class="hairstyle-options-group-wrapper" style="display: none;">
                <div class="style-option" data-prompt="A shoulder-length cut with soft waves and natural volume, warm brunette color, gentle face-framing layers.">
                    <img class="style-thumbnail" src="styles/female/style1.png" alt="Soft Wavy Layers">
                    <p>Soft Wavy Layers</p>
                </div>
                <div class="style-option" data-prompt="A long layered hairstyle with loose curls, dark brown color, flowing and romantic silhouette.">
                    <img class="style-thumbnail" src="styles/female/style2.png" alt="Long Loose Curls">
                    <p>Long Loose Curls</p>
                </div>
                <div class="style-option" data-prompt="A sleek straight bob cut at chin length, jet black color, sharp and modern profile.">
                    <img class="style-thumbnail" src="styles/female/style3.png" alt="Sleek Chin Bob">
                    <p>Sleek Chin Bob</p>
                </div>
                <div class="style-option" data-prompt="A textured lob with subtle waves, ash blonde color, effortless and airy finish.">
                    <img class="style-thumbnail" src="styles/female/style4.png" alt="Textured Wavy Lob">
                    <p>Textured Wavy Lob</p>
                </div>
                <div class="style-option" data-prompt="A short pixie cut with choppy layers, platinum blonde color, bold and edgy look.">
                    <img class="style-thumbnail" src="styles/female/style5.png" alt="Choppy Pixie Cut">
                    <p>Choppy Pixie Cut</p>
                </div>
                </div>
        </div>
    </div> 
    <canvas id="hidden-canvas" style="display: none;"></canvas>

    <div id="booking-modal-overlay" class="modal-overlay">
        <div class="booking-modal">
            <button class="modal-close-btn" id="modal-close-btn">&times;</button>
            <h2>Book Your Look</h2>
            <div class="modal-content">
                <p>You are booking the style reference below:</p>
                <img id="reference-image-preview" src="" alt="AI Generated Style Reference">
                <p style="font-size: 0.8em; margin-top: 5px; color: #555;">**Style Selected: <span id="selected-style-name"></span>**</p>
                <form id="booking-form">
                    <label for="name">Your Name</label>
                    <input type="text" id="name" name="name" required>
                    <label for="email">Email</label>
                    <input type="email" id="email" name="email" required>
                    <label for="date">Select Date</label>
                    <input type="date" id="date" name="date" required>
                    <label for="time">Select Time</label>
                    <select id="time" name="time" required>
                        <option value="">Loading availability...</option>
                    </select>
                    <button type="submit" class="submit-btn" disabled>Confirm Booking</button>
                    <p id="booking-status-message" style="margin-top: 10px; color: #dc3545; font-weight: bold;"></p>
                </form>
            </div>
        </div>
    </div>

    <script>
document.addEventListener('DOMContentLoaded', () => {
    const videoFeed = document.getElementById('video-feed');
    const aiResultImg = document.getElementById('ai-result');
    const canvas = document.getElementById('hidden-canvas');
    const cameraPlaceholderIcon = document.getElementById('camera-placeholder-icon');
    const cameraCaptureBtn = document.getElementById('camera-capture-btn');
    const redoSelfieBtn = document.getElementById('redo-selfie-btn');
    const generateLookBtn = document.getElementById('generate-look-btn');
    const bookAppointmentBtn = document.getElementById('book-appointment-btn'); 
    const spinner = document.getElementById('loading-spinner');
    const statusMessage = document.getElementById('status-message');
    const filtersAccordion = document.getElementById('additional-filters-selector');
    const complexionGroup = document.getElementById('complexion-options-group');
    const maleStyleOptionsGroup = document.getElementById('male-hairstyle-options-group');
    const femaleStyleOptionsGroup = document.getElementById('female-hairstyle-options-group');
    const maleGenderBtn = document.getElementById('male-gender-btn');
    const femaleGenderBtn = document.getElementById('female-gender-btn');
    const bookingModalOverlay = document.getElementById('booking-modal-overlay');
    const modalCloseBtn = document.getElementById('modal-close-btn');
    const bookingForm = document.getElementById('booking-form');
    const referenceImagePreview = document.getElementById('reference-image-preview');
    const selectedStyleNameSpan = document.getElementById('selected-style-name');

    let capturedImageBase64 = null;
    let selectedPrompt = null;
    let selectedStyleLabel = null; 
    let cameraStarted = false;
    let selectedGender = 'Male';
    let selectedComplexionCode = null; 
    let imageCaptured = false;
    let aiGenerationComplete = false; 

    const NEGATIVE_PROMPT = "extra fingers, blurry, low resolution, bad hands, deformed face, mask artifact, bad blending, unnatural hair hair color, ugly, tiling, duplicate, abstract, cartoon, distorted pupils, bad lighting, cropped, grainy, noise, poor lighting, poor composition, low quality, changed clothing, changed background, new outfit, new background, different lighting";

    const ALL_MALE_STYLES = [
        { code: 'default', src: "styles/male/style1.png", label: "Tousled Short Crop", prompt: "A short haircut with a tousled and textured top, dark brown color, sharp side profile." },
        { code: 'default', src: "styles/male/style2.png", label: "Wavy Clean Fade", prompt: "A clean fade with a slightly messy wavy top, medium brown color, defined jawline framing" },
        { code: 'default', src: "styles/male/style3.png", label: "Classic Side-Part", prompt: "A classic side-part with a smooth combed finish, ash black color, crisp temple blend." },
        { code: 'default', src: "styles/male/style4.png", label: "Curly Short Crop", prompt: "A short curly crop with tight texture, deep black color, taper fade around the ears." },
        { code: 'ds', src: "styles/male/ds/1.png", label: "Low Fade Coils", prompt: "A low fade with short tight coils on top, natural black color, clean hairline finish." },
        { code: 'ds', src: "styles/male/ds/2.png", label: "Classic Afro", prompt: "A classic afro with rounded shape, dense texture, bold and balanced silhouette." }
        // ... (truncated for brevity, same as original list) ...
    ];

    function shuffle(array) {
        let currentIndex = array.length, randomIndex;
        while (currentIndex !== 0) {
            randomIndex = Math.floor(Math.random() * currentIndex);
            currentIndex--;
            [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
        }
        return array;
    }
    
    function createStyleElement(style) {
        const div = document.createElement('div');
        div.className = 'style-option';
        div.dataset.prompt = style.prompt;
        div.dataset.complexionCode = style.code;
        const img = document.createElement('img');
        img.className = 'style-thumbnail';
        img.src = style.src;
        img.alt = style.label;
        const p = document.createElement('p');
        p.textContent = style.label;
        div.appendChild(img);
        div.appendChild(p);
        div.addEventListener('click', () => handleStyleSelect(div));
        return div;
    }
    
    function renderStyles(container, stylesArray) {
        container.innerHTML = ''; 
        stylesArray.forEach(style => {
            container.appendChild(createStyleElement(style));
        });
        setupScrollListeners(container);
    }

    function updateMaleStyleGallery(filterCode = null) {
        let filteredStyles = filterCode ? ALL_MALE_STYLES.filter(style => style.code === filterCode) : ALL_MALE_STYLES;
        const shuffledStyles = shuffle([...filteredStyles]);
        renderStyles(maleStyleOptionsGroup, shuffledStyles);
        selectedPrompt = null;
        selectedStyleLabel = null;
        updateButtonVisibility();
        maleStyleOptionsGroup.scrollLeft = 0;
    }

    function updateButtonVisibility() {
        cameraCaptureBtn.style.display = 'none';
        redoSelfieBtn.style.display = 'none';
        generateLookBtn.style.display = 'none';
        bookAppointmentBtn.style.display = 'none'; 
        spinner.style.display = 'none';

        if (spinner.classList.contains('active')) {
            spinner.style.display = 'block';
        } else if (aiGenerationComplete) {
            redoSelfieBtn.style.display = 'flex'; 
            bookAppointmentBtn.style.display = 'flex'; 
            statusMessage.textContent = `Success! Your new look is ready.`;
        } else if (imageCaptured) {
            redoSelfieBtn.style.display = 'flex'; 
            if (selectedPrompt) {
                generateLookBtn.style.display = 'flex'; 
                statusMessage.textContent = `Style selected: ${selectedStyleLabel}. Click âœ¨ to generate.`;
            } else {
                statusMessage.textContent = "Image captured. Select a hairstyle.";
            }
        } else {
            cameraCaptureBtn.style.display = 'flex';
            cameraCaptureBtn.disabled = !cameraStarted; 
            statusMessage.textContent = cameraStarted ? "Click ðŸ“¸ to capture." : "Tap the silhouette above.";
        }
    }
    
    function handleStyleSelect(styleOption) {
        const scrollContainer = styleOption.closest('.hairstyle-options-group-wrapper');
        if (scrollContainer) {
            const containerWidth = scrollContainer.clientWidth;
            const optionWidth = styleOption.offsetWidth;
            const scrollTarget = styleOption.offsetLeft - (containerWidth / 2) + (optionWidth / 2);
            scrollContainer.scrollTo({ left: scrollTarget, behavior: 'smooth' });
        }
    }

    async function startCamera() {
        try {
            const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'user' } });
            videoFeed.srcObject = stream;
            cameraStarted = true;
            cameraPlaceholderIcon.style.display = 'none'; 
            videoFeed.style.display = 'block'; 
            updateButtonVisibility();
        } catch (e) { console.error(e); }
    }

    cameraCaptureBtn.addEventListener('click', () => {
        const context = canvas.getContext('2d');
        canvas.width = videoFeed.videoWidth;
        canvas.height = videoFeed.videoHeight;
        context.drawImage(videoFeed, 0, 0);
        capturedImageBase64 = canvas.toDataURL('image/jpeg').split(',')[1];
        imageCaptured = true;
        videoFeed.style.display = 'none';
        aiResultImg.style.display = 'block';
        aiResultImg.src = canvas.toDataURL('image/jpeg');
        updateButtonVisibility();
    });

    cameraPlaceholderIcon.addEventListener('click', startCamera);
    
    // Initial setup
    updateMaleStyleGallery(null);
    maleGenderBtn.classList.add('selected');
});
    </script>
</body>
</html>
